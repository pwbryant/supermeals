<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Javascript Tests</title>
	<link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-2.4.1.css">
	<script src="https://code.jquery.com/qunit/qunit-2.4.1.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="../meal_maker.js"></script>
</head>
<body>
	<div id="qunit"></div>
	<div id="qunit-fixture">

		<input id='id_goal_meal_cals' type='text' name='goal_meal_cals' placeholder='cals'/>
		<select id='id_goal_meal_cals_select'>
			<option value="header">Saved Cals</option>
			<option value="602">Meal 1,2,3 - 602 cals</option>
			<option value="305">Meal 4 - 305 cals</option>
		</select>

		<table id='id_goal_meal_macros_table'>
			<tr><th></th><th>Percent</th><th>Grams</th></tr>
			<tr><td>Fat</td><td>34</td><td>-</td></tr>
			<tr><td>Carbs</td><td>33</td><td>-</td></tr>
			<tr><td>Protein</td><td>33</td><td>-</td></tr>
		</table>

	</div>
	

	<!--end of test mocks-->
	<!------------------------------------------------------------------------------------------------------------------ -->
	<!------------------------------------------------------------------------------------------------------------------ -->
	<!--QUnit TESTS -->
	<script>
		//macros breakdown table and goal cals selection
		QUnit.test('meal cal selection fills in breakdown table grams',function (assert) {
			goal_meal_cals_dropdown_fills_in_grams();
			$('#id_goal_meal_cals_select').val('305').trigger('change');
			$('#id_goal_meal_cals_select>option:eq(1)').prop('selected',true);
			fat_grams = $('#id_goal_meal_macros_table td:eq(2)').text()
			carbs_grams = $('#id_goal_meal_macros_table td:eq(5)').text()
			protein_grams = $('#id_goal_meal_macros_table td:eq(8)').text()
			
			assert.equal(fat_grams,'12');	
			assert.equal(carbs_grams,'25');	
			assert.equal(protein_grams,'25');	
		});		

		QUnit.test('meal cal input fills in breakdown table grams',function (assert) {
			goal_meal_cals_input_fills_in_grams();
			$('#id_goal_meal_cals').val('500');
			$('#id_goal_meal_cals').trigger('keyup');
			fat_grams = $('#id_goal_meal_macros_table td:eq(2)').text()
			carbs_grams = $('#id_goal_meal_macros_table td:eq(5)').text()
			protein_grams = $('#id_goal_meal_macros_table td:eq(8)').text()
			
			assert.equal(fat_grams,'19');	
			assert.equal(carbs_grams,'41');	
			assert.equal(protein_grams,'41');	
		});		

		QUnit.test('meal cal selection clears meal cal input',function (assert) {
			goal_meal_cals_dropdown_fills_in_grams();
			$('#id_goal_meal_cals').val('500');
			$('#id_goal_meal_cals_select').val('305').trigger('change');
			$('#id_goal_meal_cals_select>option:eq(1)').prop('selected',true);
			cals_input = $('#id_goal_meal_cals').val();
			assert.equal(cals_input,'');
		});		

		QUnit.test('meal cal input sets dropdown to header',function (assert) {
			goal_meal_cals_dropdown_fills_in_grams();
			$('#id_goal_meal_cals').val('500');
			select_val = $('#id_goal_meal_cals_select option:selected').val();
			assert.equal(select_val,'header');
		});		
	</script>
</body>
</html>

